<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="css\home_page.css"/>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <style>
        .Recommend-pic {
            overflow-x: auto;
            white-space: nowrap;
            padding: 10px;
        }
        .Recommend-image_item {
            display: inline-block;
            margin-right: 10px;
            transition: transform 0.3s ease;
        }
        .Recommend-image_item:hover {
            transform: scale(1.1);
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1080, shrink-to-fit=0">
    <title>RETROPLACE Home Page</title>
</head>
<body>
    <div id="main">
        <header>
            <nav class="topnav">  
                <a href="/" class="nav-brand">RETROPLACE</a>
                <a href="/" class="nav-link">Home</a>
                <a href="/search" class="nav-link">Search</a>
                <a href="/All_products" class="nav-link">All Product</a>
                <a href="#" onclick="signOut()" class="nav-link">Logout</a>
            </nav>
        </header>
        <div class="Search_home">
            <form class="search_bar">
                <i class="material-icons">search</i>
                <input type="text" placeholder="What you are looking for?"> 
                <button >Search</button>
            </form>
        </div>
        <div role="content" class="container">
            <div class="Home_Recommend">
                <div class="Home_Recommend_content">
                    <div class="Home_Recommend_text">Recommend</div>
                    <div class="Recommend_pic">
                        <ul id="list" class="Recommend-image_item-list">
                            <!-- Products will be added here dynamically -->
                        </ul>
                    </div>
                </div>                
            </div>
        </div>
    </div>
        
    <footer>
        &copy; 2024 Our Store All rights reserved
    </footer>
    <script>
       const list = document.getElementById("list");


       async function fetchProducts() {
    try {
        // Assuming you have an API endpoint to fetch products
        const response = await fetch("http://localhost:3030/product_info");
        const products = await response.json();

        // Clear existing content
        list.innerHTML = "";

        // Loop to select 4 random products without duplicates
        for (let i = 0; i < 4; i++) {
            // Ensure there are products left to choose from
            if (products.length > 0) {
                // Choose a random product index
                const randomIndex = Math.floor(Math.random() * products.length);
                const product = products[randomIndex];
                
                // Remove the selected product from the products array
                products.splice(randomIndex, 1);

                // Create list item and elements
                const li = document.createElement("li");
                const img = document.createElement("img");
                img.src = product.image_url; // Make sure product.image contains the correct URL
                img.alt = product.title; // Optional: Set alt attribute for accessibility
                const title = document.createElement("div");
                title.textContent = product.title;
                const price = document.createElement("div");
                price.textContent = product.price;
                const currency = document.createTextNode(" Baht"); // Text node for " Baht"

                // Add classes to the elements
                li.classList.add("text-product");
                img.classList.add("Image-Carousel-item");
                title.classList.add("text-product");
                price.classList.add("text-product");

                // Append elements to the list item
                li.appendChild(img);
                li.appendChild(title);
                li.appendChild(price);
                price.appendChild(currency); // Append " Baht" after the price

                // Append list item to the list
                list.appendChild(li);
            }
        }
    } catch (error) {
        console.error("Error fetching products:", error);
        // Handle error (e.g., display a message to the user)
    }
}


fetchProducts();

    function signOut() {
    fetch('/signout', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => {
        if (response.ok) {
            // Clear session data from the client-side
            window.location.reload(); // Reload the page or do any other action as needed
        } else {
            console.error('Failed to sign out');
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
    </script>
</body>
</html>
