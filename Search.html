<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="css/Search.css"/>
<meta charset="UTF-8">
<meta name="viewport" content="width=1080, shrink-to-fit=0">
<title>Retroplace</title>
</head>
<body>

<nav class="topnav">  
    <a href="/" class="nav-brand">RETROPLACE</a>
    <a href="/Homepage" class="nav-link">Home</a>
    <a href="/search" class="nav-link">Search</a>
    <a href="/All_products" class="nav-link">All Product</a>
    <a href="#" onclick="signOut()" class="nav-link">Logout</a>
</nav>

<div class="search-container">
  <h1>Find Your Product</h1>
  <form id="searchForm">
    <label for="query">Name or Description of Product</label>
    <input type="text" id="query" name="query" required>
    
    <label for="category">Filter by Category</label>
    <select id="category" name="category">
      <option value="">All Categories</option>
      <option value="Men's clothing">Men's clothing</option>
      <option value="Jewelry">Jewelry</option>
      <option value="Electronics">Electronics</option>
      <option value="Women's clothing">Women's clothing</option>
    </select>
    
    <button type="button" onclick="search()">Search</button>
    <button type="reset">Clear</button>
  </form>
</div>

<ul id="results"></ul>

<script>
  const results = document.getElementById("results");
  const queryInput = document.getElementById("query");
  const categorySelect = document.getElementById("category");

  async function search() {
    results.innerHTML = "";
    const query = queryInput.value.trim();
    const category = categorySelect.value;

    // Search for products
    let productAPIURL = `http://localhost:3030/product_info?search=${query}&category=${category}`;
    const productResponse = await fetch(productAPIURL);
    const productData = await productResponse.json();
    displayResults(productData);
  }

  function displayResults(data) {
    data.forEach(item => {
      const li = document.createElement("li");
      const title = document.createElement("h3");
      title.textContent = item.title;
      li.appendChild(title);

      const category = document.createElement("p");
      category.textContent = "Category: " + item.category;
      li.appendChild(category);

      const price = document.createElement("p");
      price.textContent = "Price: $" + item.price.toFixed(2);
      li.appendChild(price);

      const description = document.createElement("p");
      description.textContent = "Description: " + item.Pdescription;
      li.appendChild(description);

      const image = document.createElement("img");
      image.height = 500;
      image.src = item.image_url;
      image.alt = title.textContent;
      li.appendChild(image);

      results.appendChild(li);
      
    });
  }
</script>

</body>
</html>
