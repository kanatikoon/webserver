<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" type="text/css" href="css/Log_rig.css">
</head>
<nav class="topnav">  
    <a href="/" class="nav-brand">RETROPLACE</a>
    <a href="/" class="nav-link">Home</a>
    <a href="/About-Us" class="nav-link">About Us</a>
</nav>
<body>
    <div class="container">
        <div class="login-box">
            <h1>Getting Started<br></h1>
            <form id="loginForm">
                <div class="input-group">
                    <label for="username" class="input-label">Username&nbsp;</label>
                    <input type="text" id="username" name="username" class="username-input">
                </div>
                <div class="input-group">
                    <label for="password" class="input-label">Password&nbsp;</label>
                    <input type="password" id="password" name="password" class="password-input">
                </div>                
                <div class="button-group">
                    <button type="submit">Login</button>
                    <a href="/Register" class="register-link">Register</a>
                </div>                
            </form>
        </div>
    </div>  
</body>
<script>
    document.getElementById('loginForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the form from submitting normally
        
        // Get the input values
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        // Construct JSON data
        const jsonData = {
            username: username,
            password: password
        };

        fetch('/check_login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(jsonData)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.text();
        })
        .then(message => {
            if (message === "admin") {
                window.location.href = '/admin';
            } else if (message === 'user') {
                window.location.href = '/Homepage'; 
            } else {
                alert('Invalid username or password, bro.');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while logging in. Please try again later.');
        });
    });

</script>
</html>
